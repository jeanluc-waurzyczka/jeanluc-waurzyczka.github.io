// il faut tout modifier pour obtenir la liste des messages status et les afficher, en param√®tres ID et ReadApiKey comme sur les autres templates

<html lang="fr-FR";>
<head>
<meta  charset=UTF-8">
</head>
<body>
  <div id="chart-container">
<p id="AffichageTitre" style="text-align:right; color:#040457;"></p>
  <style type="text/css">
  { background-color: white; height: 100%; margin: 0; padding: 0;}
a { text-decoration:none;}
  #chart-container { width: 600px; height: 55px; display: block; position:absolute; bottom:0; top:0; left:0; right:0; margin: 5px 15px 15px 0; overflow: hidden; }
</style>
  
<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js'></script>

<script type="text/javascript">

var TexteTitre = "<span style=\"font-size:1.875em;\"><a target=\"_top\" href=\"http://waurzyczka.com/";
var TexteTitre1 = "/\"><strong>";
var TexteTitre2 = "</strong></a> </span><span style=\"font-size:1.125em;\"> { ";
var TexteTitre3 = ":";
var TexteTitre4 = " }</span></p>";

var site = getUrlVars () ["site"];

var room = getUrlVars()["room"];

var date_last_update;

var channel_id = getUrlVars()["Channel_ID"];

var read_api_key = getUrlVars()["Read_API_Key"];

var MinutesTemp;

var MinutesWorking;

var data;

$.getJSON( 'https://api.thingspeak.com/channels/' + channel_id + '/feeds/last.json?api_key=' + read_api_key, function(data) {
TexteTitre += site;
TexteTitre += TexteTitre1;
TexteTitre += room;
TexteTitre += TexteTitre2
date_last_update = new Date(data.created_at);
TexteTitre += date_last_update.getHours();
TexteTitre += TexteTitre3;
MinutesWorking = date_last_update.getMinutes();
if (MinutesWorking < 10) {MinutesTemp = '0'; MinutesTemp += MinutesWorking;}
	else {MinutesTemp = MinutesWorking;}
TexteTitre += MinutesTemp;
TexteTitre += " ";  
TexteTitre += date_last_update.toDateString();
TexteTitre += TexteTitre4;
document.getElementById("AffichageTitre").innerHTML = TexteTitre;
	
  }	);

// Get a parameter from the URL 
function getUrlVars() 
{
	var vars = {}; 
	window.location.search.replace(/[?&]+([^=&]+)=([^&]*)/gi, 
	function(m,key,value) 
	{ 
	key = decodeURIComponent(key);
		value = decodeURIComponent(value);
		vars[key] = value; 
	}); 
	return vars;

}  
</script>
</div>
</body>
</html>